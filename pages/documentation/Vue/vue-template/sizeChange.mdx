## 15. element 组件 size 切换

### 15.1 定义类型

src/plugins/element.ts

```ts
export type Size = "default" | "large" | "small";
```

### 15.2 创建 sizeSelect 组件

```vue
<template>
  <el-dropdown trigger="click" @command="handleSize">
    <div>
      <svg-icon class-name="size-icon" icon-class="size"></svg-icon>
    </div>
    <template #dropdown>
      <el-dropdown-menu>
        <el-dropdown-item
          v-for="item in sizeOptions"
          :key="item.value"
          :command="item.value"
          :disabled="item.value === size"
        >
          {{ item.label }}
        </el-dropdown-item>
      </el-dropdown-menu>
    </template>
  </el-dropdown>
</template>

<script lang="ts" setup>
import { Size } from "@/plugins/element";
import { useAppStore } from "@/stores/app";
import { storeToRefs } from "pinia";

const store = useAppStore();
const { size } = storeToRefs(store);

const { proxy } = getCurrentInstance()!;
const sizeOptions = ref([
  { label: "Default", value: "default" },
  { label: "Large", value: "large" },
  { label: "Small", value: "small" },
]);

const handleSize = (command: Size) => {
  store.setSize(command);
  proxy?.$message.success({
    type: "success",
    message: "Switch Size Success",
  });
};
</script>
<style lang="scss">
.size-icon {
  font-size: 18px;
}
</style>
```

`navbar`中导入组件并调整样式

src/layout/components/Navbar.vue

```vue
<template>
  <div class="navbar">
    <hambuger
      @toggleClick="toggleSidebar"
      :is-active="sidebar.opened"
    ></hambuger>
    <breadcrumb></breadcrumb>
    <div class="right-menu">
      <screenfull class="right-menu-item hover-effect"></screenfull>

      <el-tooltip content="Global Size" effect="dark">
        <size-select class="right-menu-item hover-effect" />
      </el-tooltip>
    </div>
  </div>
</template>

<script lang="ts" setup>
import { storeToRefs } from "pinia";
import { useAppStore } from "@/stores/app";

const store = useAppStore();
const { sidebar } = storeToRefs(store);

const toggleSidebar = () => {
  store.toggleSidebar();
};
</script>

<style lang="scss" scoped>
.navbar {
  // height: 50px;
  display: flex;
  .right-menu {
    flex: 1;
    display: flex;
    align-items: center;
    justify-content: flex-end;
    padding-right: 15px;
    &-item {
      padding: 0 8px;
      font-size: 18px;
      color: #5a5e66;
      vertical-align: text-bottom;
      &.hover-effect {
        cursor: pointer;
        transition: background 0.3s;
        &:hover {
          background: rgba(0, 0, 0, 0.025);
        }
      }
    }
  }
}
</style>
```

### 15.3 size 属性添加到 store

修改 src/stores/app.ts

```ts
import { defineStore } from "pinia";
import { Size } from "@/plugins/element";

interface stateType {
  sidebar: sidebarType;
  size: Size;
}

interface sidebarType {
  opened: boolean;
}

export const useAppStore = defineStore(
  "app",
  () => {
    const state = reactive<stateType>({
      sidebar: {
        opened: true,
      },
      size: "default",
    });
    const sidebar = computed(() => state.sidebar);
    const size = computed(() => state.size);

    const toggleSidebar = () => {
      state.sidebar.opened = !state.sidebar.opened;
    };
    const setSize = (size: Size) => {
      state.size = size;
    };

    return {
      state,
      sidebar,
      size,
      setSize,
      toggleSidebar,
    };
  },
  {
    persist: {
      storage: window.sessionStorage,
      paths: ["state.sidebar.opened", "state.size"],
    },
  }
);
```

:::tip
注意这里的 `stateType`、`sidebarType` 这两个类型，如果不定义的话，在 App.vue 中 `el-config-provider` 的 `size` 属性会提示错误，解决的方法有两种：

1. size as any
2. 在定义 size 的时候就给上类型即可
   :::

### 15.4 设置组件 siz

src/components/SizeSelect/index.vue

```ts
import { useAppStore } from "@/stores/app";
import { storeToRefs } from "pinia";

const store = useAppStore();
const { size } = storeToRefs(store);
```

将 `size` 应用在 `App.vue` 中

```vue
<template>
  <el-config-provider :size="size">
    <router-view></router-view>
  </el-config-provider>
</template>

<script setup lang="ts">
import { useAppStore } from "@/stores/app";
import { storeToRefs } from "pinia";
const store = useAppStore();
const { size } = storeToRefs(store);
</script>
```

### 15.5 组件国际化

```vue
<template>
  <el-config-provider :size="size" :locale="zhCn">
    <router-view></router-view>
  </el-config-provider>
</template>
<script setup lang="ts">
import zhCn from "element-plus/dist/locale/zh-cn.mjs";
</script>
```

这里还需要在 `src/vite-env.d.ts` 中添加类型声明

```ts
declare module "element-plus/dist/locale/zh-cn.mjs";
```